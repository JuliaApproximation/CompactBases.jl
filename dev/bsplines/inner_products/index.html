<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Inner products and norms · CompactBases.jl</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><script src="../../assets/latex.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.svg" alt="CompactBases.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit">CompactBases.jl</span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../overview/">Overview</a></li><li><a class="tocitem" href="../../inner_products/">Inner products &amp; norms</a></li><li><span class="tocitem">Operators</span><ul><li><a class="tocitem" href="../../diagonal_operators/">Diagonal operators</a></li></ul></li><li><a class="tocitem" href="../../densities/">Densities</a></li><li><span class="tocitem">Finite-differences</span><ul><li><a class="tocitem" href="../../fd_overview/">Overview</a></li><li><a class="tocitem" href="../../fd_non_uniform/">Non-uniform grids</a></li></ul></li><li><span class="tocitem">B-splines</span><ul><li><a class="tocitem" href="../theory/">Theory</a></li><li><input class="collapse-toggle" id="menuitem-7-2" type="checkbox"/><label class="tocitem" for="menuitem-7-2"><span class="docs-label">Usage</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../usage/">Basis creation</a></li><li><a class="tocitem" href="../knot_sets/">Knot sets</a></li><li><input class="collapse-toggle" id="menuitem-7-2-3" type="checkbox"/><label class="tocitem" for="menuitem-7-2-3"><span class="docs-label">Splines</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../splines/">Spline creation &amp; evaluation</a></li><li><a class="tocitem" href="../function_approximation/">Function approximation</a></li></ul></li><li><a class="tocitem" href="../operators/">Approximating operators</a></li><li><input class="collapse-toggle" id="menuitem-7-2-5" type="checkbox"/><label class="tocitem" for="menuitem-7-2-5"><span class="docs-label">Examples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../differentiation/">Differentiating functions</a></li><li><a class="tocitem" href="../odes/">Ordinary differential equations</a></li><li><a class="tocitem" href="../eigenproblems/">Eigenproblems</a></li></ul></li></ul></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Inner products and norms</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Inner products and norms</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/JuliaApproximation/CompactBases.jl/blob/master/docs/src/bsplines/inner_products.md#L" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Inner-products-and-norms-1"><a class="docs-heading-anchor" href="#Inner-products-and-norms-1">Inner products and norms</a><a class="docs-heading-anchor-permalink" href="#Inner-products-and-norms-1" title="Permalink"></a></h1><p>The inner product between two splines is given by</p><div>\[\begin{equation}
\label{eqn:inner-product}
\braket{s}{\tilde{s}} \defd
\int\diff{x} \conj{s}(x) \tilde{s}(x) \approx
\sum_l w_l \conj{s}(x_l) \tilde{s}(x_l).
\end{equation}\]</div><p>From the <a href="../splines/">definition of a spline</a>, we have</p><div>\[\begin{equation}
\tag{\ref{eqn:inner-product}*}
\braket{s}{\tilde{s}} = (B\vec{c})^HB\vec{\tilde{c}} = \vec{c}^H \mat{S} \vec{\tilde{c}},
\end{equation}\]</div><p>where the overlap matrix is given by</p><div>\[\begin{equation}
\label{eqn:overlap-matrix}
\mat{S}_{ij} \defd
\braket{\B{i}{k}}{\B{j}{k}} \approx
\sum_l w_l \conj{\B{i}{k}(x_l)}{\B{j}{k}(x_l)}.
\end{equation}\]</div><p>When the B-spline basis is created, the B-splines are evaluated on the quadrature roots and stored in a sparse matrix, and the banded overlap matrix is formed:</p><pre><code class="language-julia">julia&gt; B = BSpline(LinearKnotSet(7, 0, 1, 10))
BSpline{Float64} basis with LinearKnotSet(Float64) of order k = 7 on 0.0..1.0 (10 intervals)

julia&gt; B.B
80×16 SparseArrays.SparseMatrixCSC{Float64,Int64} with 560 stored entries:
  [1 ,  1]  =  0.886629
  [2 ,  1]  =  0.525563
  [3 ,  1]  =  0.196947
  [4 ,  1]  =  0.0429226
  [5 ,  1]  =  0.00463197
  [6 ,  1]  =  0.000178262
  [7 ,  1]  =  1.10427e-6
  [8 ,  1]  =  6.12673e-11
  [1 ,  2]  =  0.11053
  [2 ,  2]  =  0.411336
  [3 ,  2]  =  0.543708
  [4 ,  2]  =  0.422368
  [5 ,  2]  =  0.234511
  [6 ,  2]  =  0.111732
  [7 ,  2]  =  0.0558643
  [8 ,  2]  =  0.0351626
  ⋮
  [73, 15]  =  0.0351626
  [74, 15]  =  0.0558643
  [75, 15]  =  0.111732
  [76, 15]  =  0.234511
  [77, 15]  =  0.422368
  [78, 15]  =  0.543708
  [79, 15]  =  0.411336
  [80, 15]  =  0.11053
  [73, 16]  =  6.12673e-11
  [74, 16]  =  1.10427e-6
  [75, 16]  =  0.000178262
  [76, 16]  =  0.00463197
  [77, 16]  =  0.0429226
  [78, 16]  =  0.196947
  [79, 16]  =  0.525563
  [80, 16]  =  0.886629

julia&gt; B.S
16×16 BandedMatrix{Float64,Array{Float64,2},Base.OneTo{Int64}}:
 0.00769231   0.00492814   0.00142795   0.000218646  1.79179e-5   7.31907e-7   …   ⋅            ⋅            ⋅            ⋅            ⋅
 0.00492814   0.0110567    0.00855534   0.00328365   0.000674239  7.04773e-5       ⋅            ⋅            ⋅            ⋅            ⋅
 0.00142795   0.00855534   0.0147851    0.0118803    0.00501486   0.00109218       ⋅            ⋅            ⋅            ⋅            ⋅
 0.000218646  0.00328365   0.0118803    0.0187451    0.015232     0.00647614       ⋅            ⋅            ⋅            ⋅            ⋅
 1.79179e-5   0.000674239  0.00501486   0.015232     0.0232999    0.0188319        ⋅            ⋅            ⋅            ⋅            ⋅
 7.31907e-7   7.04773e-5   0.00109218   0.00647614   0.0188319    0.0289487    …  1.92709e-11   ⋅            ⋅            ⋅            ⋅
 1.15625e-8   2.93435e-6   0.000100846  0.00126285   0.0074747    0.0228901       1.57581e-7   3.01107e-11   ⋅            ⋅            ⋅
  ⋅           3.61328e-10  5.83108e-7   4.39448e-5   0.000854471  0.00665362      2.83876e-5   2.46171e-7   7.13735e-11   ⋅            ⋅
  ⋅            ⋅           7.13735e-11  2.46171e-7   2.83876e-5   0.000726484     0.000854471  4.39448e-5   5.83108e-7   3.61328e-10   ⋅
  ⋅            ⋅            ⋅           3.01107e-11  1.57581e-7   2.37367e-5      0.0074747    0.00126285   0.000100846  2.93435e-6   1.15625e-8
  ⋅            ⋅            ⋅            ⋅           1.92709e-11  1.31324e-7   …  0.0188319    0.00647614   0.00109218   7.04773e-5   7.31907e-7
  ⋅            ⋅            ⋅            ⋅            ⋅           1.92709e-11     0.0232999    0.015232     0.00501486   0.000674239  1.79179e-5
  ⋅            ⋅            ⋅            ⋅            ⋅            ⋅              0.015232     0.0187451    0.0118803    0.00328365   0.000218646
  ⋅            ⋅            ⋅            ⋅            ⋅            ⋅              0.00501486   0.0118803    0.0147851    0.00855534   0.00142795
  ⋅            ⋅            ⋅            ⋅            ⋅            ⋅              0.000674239  0.00328365   0.00855534   0.0110567    0.00492814
  ⋅            ⋅            ⋅            ⋅            ⋅            ⋅           …  1.79179e-5   0.000218646  0.00142795   0.00492814   0.00769231</code></pre><p>If we thus have to vectors of expansion coefficients, we can calculate the inner product of the correspond splines very simply:</p><pre><code class="language-julia">julia&gt; c = B \ x -&gt; sin(2π*x)
16-element Array{Float64,1}:
  1.5675074227379815e-7
  0.10471902453028906
  0.3141611768331591
  0.6159137789819404
  0.9438219608666177
  1.1224640274531983
  0.9080930336327867
  0.34686036375515594
 -0.3468603637551552
 -0.9080930336327886
 -1.1224640274531954
 -0.9438219608666232
 -0.6159137789819348
 -0.3141611768331642
 -0.10471902453028659
 -1.567507426314564e-7

julia&gt; c̃ = B \ x -&gt; cos(2π*x)
16-element Array{Float64,1}:
  1.0000000051659867
  1.0000000496779038
  0.9736805198549477
  0.8552480183377358
  0.5498061181490912
  3.468447866195647e-7
 -0.6597681895565798
 -1.0675270371816847
 -1.0675270371816876
 -0.6597681895565795
  3.4684478615396205e-7
  0.5498061181490913
  0.855248018337735
  0.9736805198549482
  1.0000000496779042
  1.0000000051659863

julia&gt; c&#39;*B.S*c̃
1-element Array{Float64,1}:
 9.71445146547012e-17</code></pre><p>[orthogonal, as expected, since <span>$\int_0^1\diff{x}\sin(2\pi x)\cos(2\pi x)=0$</span>]. However, instead of manually supplying the overlap matrix <span>$\mat{S}$</span>, it is more convenient to first construct the splines and then compute the inner product:</p><pre><code class="language-julia">julia&gt; s = B*c
Spline on BSpline{Float64} basis with LinearKnotSet(Float64) of order k = 7 on 0.0..1.0 (10 intervals)

julia&gt; s̃ = B*c̃
Spline on BSpline{Float64} basis with LinearKnotSet(Float64) of order k = 7 on 0.0..1.0 (10 intervals)

julia&gt; s&#39;s̃
ContinuumArrays.QuasiArrays.ApplyQuasiArray{Float64,1,LazyArrays.Applied{ContinuumArrays.QuasiArrays.LazyQuasiArrayApplyStyle,typeof(*),Tuple{Adjoint{Float64,Array{Float64,1}},ContinuumArrays.QuasiArrays.QuasiAdjoint{Float64,BSpline{Float64,Float64,LinearKnotSet{7,7,7,Float64,StepRangeLen{Float64,Base.TwicePrecision{Float64},Base.TwicePrecision{Float64}}},Array{Float64,1},Array{Float64,1},SparseArrays.SparseMatrixCSC{Float64,Int64},BandedMatrices.BandedMatrix{Float64,Array{Float64,2},Base.OneTo{Int64}}}},BSpline{Float64,Float64,LinearKnotSet{7,7,7,Float64,StepRangeLen{Float64,Base.TwicePrecision{Float64},Base.TwicePrecision{Float64}}},Array{Float64,1},Array{Float64,1},SparseArrays.SparseMatrixCSC{Float64,Int64},BandedMatrices.BandedMatrix{Float64,Array{Float64,2},Base.OneTo{Int64}}},Array{Float64,1}}}}([1.56751e-7 0.104719 … -0.104719 -1.56751e-7]⋆ContinuumArrays.QuasiArrays.QuasiAdjoint{Float64,BSpline{Float64,Float64,LinearKnotSet{7,7,7,Float64,StepRangeLen{Float64,Base.TwicePrecision{Float64},Base.TwicePrecision{Float64}}},Array{Float64,1},Array{Float64,1},SparseArrays.SparseMatrixCSC{Float64,Int64},BandedMatrices.BandedMatrix{Float64,Array{Float64,2},Base.OneTo{Int64}}}}(BSpline{Float64} basis with LinearKnotSet(Float64) of order k = 7 on 0.0..1.0 (10 intervals))⋆BSpline{Float64} basis with LinearKnotSet(Float64) of order k = 7 on 0.0..1.0 (10 intervals)⋆[1.0, 1.0, 0.973681, 0.855248, 0.549806, 3.46845e-7, -0.659768, -1.06753, -1.06753, -0.659768, 3.46845e-7, 0.549806, 0.855248, 0.973681, 1.0, 1.0])</code></pre></article></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Wednesday 8 July 2020 08:53">Wednesday 8 July 2020</span>. Using Julia version 1.4.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
