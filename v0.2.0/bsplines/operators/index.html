<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Approximating operators · CompactBases.jl</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><script src="../../assets/latex.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.svg" alt="CompactBases.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit">CompactBases.jl</span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../overview/">Overview</a></li><li><a class="tocitem" href="../../inner_products/">Inner products &amp; norms</a></li><li><span class="tocitem">Operators</span><ul><li><a class="tocitem" href="../../diagonal_operators/">Diagonal operators</a></li></ul></li><li><a class="tocitem" href="../../densities/">Densities</a></li><li><span class="tocitem">Finite-differences</span><ul><li><a class="tocitem" href="../../fd_overview/">Overview</a></li><li><a class="tocitem" href="../../fd_non_uniform/">Non-uniform grids</a></li></ul></li><li><span class="tocitem">B-splines</span><ul><li><a class="tocitem" href="../theory/">Theory</a></li><li><input class="collapse-toggle" id="menuitem-7-2" type="checkbox" checked/><label class="tocitem" for="menuitem-7-2"><span class="docs-label">Usage</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../usage/">Basis creation</a></li><li><a class="tocitem" href="../knot_sets/">Knot sets</a></li><li><input class="collapse-toggle" id="menuitem-7-2-3" type="checkbox"/><label class="tocitem" for="menuitem-7-2-3"><span class="docs-label">Splines</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../splines/">Spline creation &amp; evaluation</a></li><li><a class="tocitem" href="../function_approximation/">Function approximation</a></li></ul></li><li class="is-active"><a class="tocitem" href>Approximating operators</a><ul class="internal"><li><a class="tocitem" href="#Differential-operators-1"><span>Differential operators</span></a></li><li><a class="tocitem" href="#Diagonal-operators-1"><span>Diagonal operators</span></a></li></ul></li><li><input class="collapse-toggle" id="menuitem-7-2-5" type="checkbox"/><label class="tocitem" for="menuitem-7-2-5"><span class="docs-label">Examples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../differentiation/">Differentiating functions</a></li><li><a class="tocitem" href="../odes/">Ordinary differential equations</a></li><li><a class="tocitem" href="../eigenproblems/">Eigenproblems</a></li></ul></li></ul></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">B-splines</a></li><li><a class="is-disabled">Usage</a></li><li class="is-active"><a href>Approximating operators</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Approximating operators</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/JuliaApproximation/CompactBases.jl/blob/master/docs/src/bsplines/operators.md#L" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Approximating-operators-1"><a class="docs-heading-anchor" href="#Approximating-operators-1">Approximating operators</a><a class="docs-heading-anchor-permalink" href="#Approximating-operators-1" title="Permalink"></a></h1><p>As mentioned in <a href="../theory/#Solving-equations-1">Solving equations</a>, the action of a linear operator on a spline can be approximated by projecting the operator into the space <span>$\space{P}_{t,k}$</span>: <span>$\mat{L}\defd B^H\operator{L}B$</span>. We can employ this for different kinds of operators; out-of-the-box, CompactBases.jl supports differential operators and diagonal operators:</p><h2 id="Differential-operators-1"><a class="docs-heading-anchor" href="#Differential-operators-1">Differential operators</a><a class="docs-heading-anchor-permalink" href="#Differential-operators-1" title="Permalink"></a></h2><p>In the ContinuumArrays framework, differential operators are represented by the <code>Derivative</code> operator, which operates in a domain (typically the first axis of an <code>ContinuumArrays.QuasiArrays.AbstractQuasiMatrix</code>, e.g. a <code>ContinuumArrays.Basis</code> such as <a href="../usage/#CompactBases.BSpline"><code>BSpline</code></a>):</p><pre><code class="language-julia">julia&gt; using CompactBases

julia&gt; B = BSpline(LinearKnotSet(3, 0, 1, 3))
BSpline{Float64} basis with LinearKnotSet(Float64) of order k = 3 (parabolic) on 0.0..1.0 (3 intervals)

julia&gt; D = Derivative(axes(B,1))
Derivative{Float64,IntervalSets.Interval{:closed,:closed,Float64}}(ContinuumArrays.QuasiArrays.Inclusion{Float64,IntervalSets.Interval{:closed,:closed,Float64}}(0.0..1.0))</code></pre><p>The derivative operator can then be projected into the space generated by the knot set <code>t</code> by</p><pre><code class="language-julia">julia&gt; ∇ = B&#39;D*B
5×5 BandedMatrix{Float64,Array{Float64,2},Base.OneTo{Int64}}:
 -0.5         0.416667      0.0833333      ⋅            ⋅
 -0.416667    2.07997e-17   0.375         0.0416667     ⋅
 -0.0833333  -0.375         7.84759e-17   0.375        0.0833333
   ⋅         -0.0416667    -0.375        -1.31839e-16  0.416667
   ⋅           ⋅           -0.0833333    -0.416667     0.5</code></pre><h2 id="Diagonal-operators-1"><a class="docs-heading-anchor" href="#Diagonal-operators-1">Diagonal operators</a><a class="docs-heading-anchor-permalink" href="#Diagonal-operators-1" title="Permalink"></a></h2><p>Diagonal operators are operators that only depend on the coordinate; they are also called local operators. Typical examples are potentials, such as the Coulomb potential <span>$V(x) = Q/x$</span>, generated by a charge <span>$Q$</span>. This potential is not polynomial, i.e. we cannot compute its matrix elements exactly using Gauß–Legendre quadrature, but with high enough order and intelligent placement of the knots, we can get sufficient accuracy.</p><p>Diagonal operators are projected into the B-spline space using a <code>QuasiDiagonal</code>.</p><p>As as example of the importance of knot placement, we study the action of the Coulomb operator <span>$\operator{V}(x) = -1/x$</span> on the function <span>$f(x)=x^2\exp(-x)$</span>; we know that the result should be <span>$g(x)=\operator{V}(x)f(x)=-x\exp(-x)$</span>:</p><pre><code class="language-julia">julia&gt; k = 7
7

julia&gt; N = 31
31

julia&gt; a,b = 0,70
(0, 70)

julia&gt; coulomb(r) = -1/r
coulomb (generic function with 1 method)

julia&gt; tlin = LinearKnotSet(k, a, b, N);

julia&gt; texp = ExpKnotSet(k, -1.0, log10(b), N);

julia&gt; Blin = BSpline(tlin,3)[:,2:end-1]
BSpline{Float64} basis with LinearKnotSet(Float64) of order k = 7 on 0.0..70.0 (31 intervals), restricted to basis functions 2..36 ⊂ 1..37

julia&gt; Bexp = BSpline(texp,3)[:,2:end-1]
BSpline{Float64} basis with ExpKnotSet(Float64) of  on order k = 7 on 0,0.1..70.00000000000001 (31 intervals), restricted to basis functions 2..36 ⊂ 1..37</code></pre><p>Then, for <code>B=Blin</code> and <code>B=Bexp</code>, we do the following:</p><pre><code class="language-julia">x = axes(B, 1)
S = B&#39;B
f = B \ (x.^2 .* exp.(-x))
V = B&#39;*QuasiDiagonal(coulomb.(x))*B
g̃ = S \ V*f</code></pre><p>and obtain two different approximations <code>g̃</code> to <span>$g(x)$</span>, as shown in the following plot:</p><p><img src="../../figures/bsplines/diagonal-operators.svg" alt="Coulomb operator"/></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../function_approximation/">« Function approximation</a><a class="docs-footer-nextpage" href="../differentiation/">Differentiating functions »</a></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Thursday 18 March 2021 00:02">Thursday 18 March 2021</span>. Using Julia version 1.5.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
